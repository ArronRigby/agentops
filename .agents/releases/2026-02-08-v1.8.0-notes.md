## Highlights

This release ships the **flywheel automation hooks** — a system of coordinating hooks that nudge agents through the RPI lifecycle (Research → Plan → Implement → Validate) without forcing invocation. Three-layer nudge hierarchy prevents nag fatigue, flag-file TTL enables cross-hook coordination, and dual-schema parsing handles evolving chain.jsonl formats. Also adds 7 safety hooks for agent guardrails including dangerous git protection, worker commit blocking, and task validation gates.

## What's New

- **Flywheel automation** — `ratchet-advance.sh` suggests next RPI skill on step completion, `session-start.sh` resumes flywheel state, `push-gate.sh` blocks push without post-mortem, `prompt-nudge.sh` deduplicates nudges
- **7 safety hooks** — Dangerous git guard, worker commit guard, task validation gate, stop team guard, precompact snapshot, standards injector, pending cleaner
- **Security fix** — Replaced `eval()` with restricted execution in task-validation-gate.sh
- **Skill enhancements** — Wave vibe gate in `/crank`, ratchet pre-flight in `/implement`, ratchet post-flight in `/vibe`

## Changelog

### Added

- **Flywheel automation hooks** (ag-oke) — RPI lifecycle hooks that nudge agents through the knowledge flywheel without forcing invocation
  - `ratchet-advance.sh` — PostToolUse hook detects `ao ratchet record` and suggests next RPI skill via additionalContext
  - `session-start.sh` ratchet resume — Reads chain.jsonl on new session, injects "RESUMING FLYWHEEL" directive with last step + artifact
  - `push-gate.sh` post-mortem gate — Blocks push when vibe exists but no post-mortem entry
  - `prompt-nudge.sh` nudge dedup — Flag-file coordination with 10-min TTL prevents triple-nudging across hooks
- **Safety and enforcement hooks** — 7 new hooks for agent guardrails
  - `dangerous-git-guard.sh` — Blocks force-push, reset --hard, clean -f, branch -D
  - `git-worker-guard.sh` — Blocks git commit/push for swarm workers (lead-only commit pattern)
  - `task-validation-gate.sh` — TaskCompleted hook validates metadata rules before accepting
  - `stop-team-guard.sh` — Prevents orphaned teams on session stop
  - `precompact-snapshot.sh` — Snapshots team state + git status before context compaction
  - `standards-injector.sh` — PreToolUse hook injects language-specific coding standards
  - `pending-cleaner.sh` — Archives stale pending queue entries at session start
- **Skill enhancements** — Metadata verification in `/crank`, wave vibe gate, pre-planning audit in `/plan`, ratchet pre-flight in `/implement`, ratchet post-flight in `/vibe`

### Fixed

- Replace `eval()` with restricted execution in task-validation-gate.sh (command injection vulnerability)
- Add missing kill switch (`AGENTOPS_HOOKS_DISABLED`) to standards-injector.sh
- Remove `set -euo pipefail` from session-start.sh (hooks must fail open)
- Fix `--format=oneline` → `-o json` for `ao ratchet status`
- Fix relative `.agents/ao` path → `git rev-parse --show-toplevel`

### Changed

- **README** — Visual-first rewrite with accurate skill examples
- **Docs** — Reference and L4 updated for native teams + lead-only commits

### Removed

- `comment-checker.sh` — Replaced by standards-injector.sh
